<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ArcGIS GeometryEngine Tutorial</title>
    <script src="https://js.arcgis.com/4.24/"></script>
    <style>
      html,
      body,
      #viewDiv {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
      }
      #controls {
        position: absolute;
        top: 10px;
        left: 10px;
        background: white;
        padding: 10px;
        z-index: 100;
      }
    </style>
  </head>
  <body>
    <script>
      require([
        "esri/Map",
        "esri/views/MapView",
        "esri/geometry/Polygon",
        "esri/geometry/Polyline",
        "esri/geometry/geometryEngine",
        "esri/layers/GraphicsLayer",
        "esri/Graphic",
      ], function (
        Map,
        MapView,
        Polygon,
        Polyline,
        geometryEngine,
        GraphicsLayer,
        Graphic
      ) {
        const map = new Map({ basemap: "streets-navigation-vector" });
        const view = new MapView({
          container: "viewDiv",
          map: map,
          center: [100.5018, 13.7563],
          zoom: 12,
        });

        // สร้าง GraphicsLayer เพื่อใส่ Graphic
        const graphicsLayer = new GraphicsLayer();
        map.add(graphicsLayer);

        const polygonSymbol = {
          type: "simple-fill",
          color: [227, 139, 79, 0.8],
          outline: {
            color: [255, 255, 255],
            width: 1,
          },
        };

        const lineSymbol = {
          type: "simple-line",
          color: [80, 200, 40],
          width: 4,
        };

        // Define a polygon
        const polygon = new Polygon({
          rings: [
            [
              [100.49, 13.75],
              [100.52, 13.75],
              [100.52, 13.77],
              [100.49, 13.77],
              [100.49, 13.75],
            ],
          ],
          spatialReference: { wkid: 4326 },
        });

        // Define a polyline that crosses the polygon
        const polyline = new Polyline({
          paths: [
            [
              [100.48, 13.76],
              [100.53, 13.76],
            ],
          ],
          spatialReference: { wkid: 4326 },
        });

        const graphicA = new Graphic({
          geometry: polygon,
          symbol: polygonSymbol,
        });
        const graphicB = new Graphic({
          geometry: polyline,
          symbol: lineSymbol,
        });
        graphicsLayer.addMany([graphicA, graphicB]);

        function checkRelations() {
          const intersects = geometryEngine.intersects(polygon, polyline);
          const crosses = geometryEngine.crosses(polygon, polyline);

          document.getElementById("output").innerHTML = `
                    <strong>Geometry Relations:</strong><br>
                    Intersects: ${intersects}<br>
                    Crosses: ${crosses}
                `;
        }
        document
          .getElementById("chkButton")
          .addEventListener("click", checkRelations);
      });
    </script>
    <div id="controls">
      <h3>GeometryEngine Relation Check</h3>
      <button id="chkButton">Check Relations</button>
      <p id="output"></p>
    </div>
    <div id="viewDiv"></div>
  </body>
</html>
